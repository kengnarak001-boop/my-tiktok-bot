import streamlit as st
import google.generativeai as genai

# --- 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API ---
API_KEY = "AIzaSyAHr1OWBYjJtXynAQ5eDoin7M13qyp8AGU"
genai.configure(api_key=API_KEY)
model = genai.GenerativeModel('gemini-2.5-flash')

st.set_page_config(page_title="TikTok 8s Bot", page_icon="‚ö°")

# CSS ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏á‡πà‡∏≤‡∏¢‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
st.markdown("""
    <style>
    .stButton>button { width: 100%; border-radius: 10px; height: 3.5em; background: linear-gradient(45deg, #FF0050, #00F2EA); color: white; font-weight: bold; border: none; }
    .stCodeBlock { border-radius: 10px; }
    </style>
    """, unsafe_allow_html=True)

st.title("‚ö° TikTok 8-Sec Generator")
st.write("‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏™‡∏±‡πâ‡∏ô 8 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÄ‡∏ô‡πâ‡∏ô‡∏à‡∏ö‡πÑ‡∏ß ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÄ‡∏£‡πá‡∏ß")

product = st.text_input("üì¶ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:", placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ß‡πà‡∏ô‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡∏¢‡∏≤‡∏ß")

if st.button("üöÄ ‡πÄ‡∏™‡∏Å‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå 8 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ"):
    if product:
        try:
            with st.spinner('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏•‡∏±‡πà‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤...'):
                # ‡∏™‡∏±‡πà‡∏á Gemini ‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
                prompt = f"""
                ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå TikTok ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ {product} ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÅ‡∏Ñ‡πà 8 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
                ‡πÇ‡∏î‡∏¢‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏™‡πà‡∏ß‡∏ô:
                1. Full Script: ‡∏ö‡∏≠‡∏Å‡∏°‡∏∏‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞ (‡πÄ‡∏ô‡πâ‡∏ô Hook ‡πÅ‡∏£‡∏á‡πÜ)
                2. Only Speech: ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô AI Video ‡∏Ç‡∏≠‡∏á CapCut (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô)
                ‡πÄ‡∏ô‡πâ‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡∏û‡πà‡∏≠‡∏Ñ‡πâ‡∏≤‡πÅ‡∏°‡πà‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏π‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à
                """
                res = model.generate_content(prompt)
                full_text = res.text

                # ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏´‡∏≤‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠)
                parts = full_text.split("Only Speech:")
                script_full = parts[0].replace("Full Script:", "").strip()
                speech_only = parts[1].strip() if len(parts) > 1 else full_text

                st.success("‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!")

                # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏ó‡∏û‡∏π‡∏î (‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏¢) ---
                st.subheader("üëÑ ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏ó‡∏û‡∏π‡∏î (‡∏Å‡∏î‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡πÑ‡∏õ‡∏ß‡∏≤‡∏á CapCut)")
                st.code(speech_only, language="text")
                st.info("üëÜ ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Copy ‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á '‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ AI' ‡∏Ç‡∏≠‡∏á CapCut ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢")

                st.divider()

                # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÄ‡∏ï‡πá‡∏° (‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á) ---
                with st.expander("üé¨ ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏°‡∏∏‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á (Full Script)"):
                    st.write(script_full)

        except Exception as e:
            st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {e}")
    else:
        st.warning("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö")

st.markdown("---")
st.caption("‡∏™‡∏π‡∏ï‡∏£‡∏•‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ 8 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ: Hook 2 ‡∏ß‡∏¥ -> ‡∏õ‡πâ‡∏≤‡∏¢‡∏¢‡∏≤ 4 ‡∏ß‡∏¥ -> ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ 2 ‡∏ß‡∏¥")